# Reload when pixi config changes
watch_file pyproject.toml
watch_file pixi.lock

# Work around missing libc++ headers in some macOS CLT installs (needed to build rasterio from sdist).
if command -v xcrun >/dev/null 2>&1; then
  if [ -z "${SDKROOT:-}" ]; then
    export SDKROOT="$(xcrun --show-sdk-path)"
  fi
  if [ -d "${SDKROOT}/usr/include/c++/v1" ]; then
    case ":${CPLUS_INCLUDE_PATH:-}:" in
      *":${SDKROOT}/usr/include/c++/v1:"*) ;;
      *) export CPLUS_INCLUDE_PATH="${SDKROOT}/usr/include/c++/v1${CPLUS_INCLUDE_PATH:+:${CPLUS_INCLUDE_PATH}}" ;;
    esac
  fi
fi

# Use pixi shell-hook for direnv integration
eval "$(pixi shell-hook)"
